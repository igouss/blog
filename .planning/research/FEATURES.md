# Feature Research

**Domain:** Personal static Markdown blog (Caddy + Tailscale)
**Researched:** 2026-02-20
**Confidence:** HIGH (table stakes/anti-features), MEDIUM (differentiators)

## Feature Landscape

### Table Stakes (Users Expect These)

Features readers assume exist. Missing these = blog feels broken or incomplete.

| Feature | Why Expected | Complexity | Infrastructure Dependency |
|---------|--------------|------------|--------------------------|
| Individual post pages | Core function — each `.md` file renders as readable HTML | LOW | Caddy `templates` handler + `markdown` function |
| Readable HTML layout | Bare unstyled HTML is unacceptable in 2026 | LOW | CSS file served by Caddy `file_server` |
| Frontmatter/metadata | Title, date, description are minimal expected metadata | LOW | Caddy `splitFrontMatter` template function |
| Post date visible | Readers judge freshness immediately; no date = unclear if stale | LOW | Frontmatter `date:` rendered by template |
| Page title in `<title>` tag | Browser tab, bookmarks, search results all rely on this | LOW | Template: `<title>{{$md.Meta.title}}</title>` |
| Navigation: home link | Every post needs a way back to the index | LOW | HTML template — header with `/` link |
| Responsive design | Mobile traffic is >50%; unresponsive = unreadable on phone | LOW | CSS: `max-width` + one responsive breakpoint |
| Blog index/listing page | Readers need to discover posts; no index = dead end | MEDIUM | Caddy cannot auto-sort `.md` files — requires a hand-maintained or script-generated `index.md` |
| Syntax highlighting for code blocks | Technical readers expect highlighted code | LOW | Built-in: Caddy's `markdown` function uses Goldmark + Chroma; CSS classes emitted automatically |

**Note on syntax highlighting:** Caddy's built-in `markdown` template function includes Chroma via goldmark-highlighting. Fenced code blocks with language tags (e.g., ` ```go `) are rendered with Chroma CSS classes automatically. A Chroma CSS theme file must be served alongside the blog CSS. No client-side JS required.

**Note on blog index:** Caddy has no native mechanism to enumerate and sort `.md` files by date. The blog index is best handled as a hand-maintained or script-generated `articles/index.md` listing posts in reverse chronological order. This is a known limitation of the no-build-step approach vs. SSGs like Hugo.

### Differentiators (Competitive Advantage)

Features that distinguish this blog. Not required, but meaningfully valued.

| Feature | Value Proposition | Complexity | Infrastructure Dependency |
|---------|-------------------|------------|--------------------------|
| Content negotiation (HTML/Markdown) | API clients and LLM agents get raw Markdown without HTML noise; 10x token reduction; Claude Code already sends `Accept: text/markdown` | MEDIUM | Caddy header matcher (`@wants-markdown`) + `Vary: Accept` response header |
| Dark mode | Reader comfort; OS-preference-aware via `prefers-color-scheme` | LOW | CSS `@media (prefers-color-scheme: dark)` — no JS, no extra infra |
| Open Graph / social preview tags | Controls appearance when shared on Slack, Discord, social media | LOW | `<meta property="og:*">` in template from frontmatter |
| `robots.txt` + `sitemap.xml` | Search engine discoverability; relevant since Funnel makes blog public | LOW | Static files served by `file_server`; `sitemap.xml` can be generated by a shell script |
| Anchor links on headings | Deep-linking to specific sections; standard for technical content | LOW | Goldmark outputs `id` attributes on headings automatically; CSS + tiny JS optional for visual links |
| `Content-Signal` header | Signals permitted AI agent uses when serving raw Markdown; emerging best practice (llms.txt adjacent) | LOW | Single Caddy `header` directive in the `@wants-markdown` handler |
| RSS/Atom feed | Readers use feed readers; absence means losing subscribers | MEDIUM | Not natively generated by Caddy — requires a shell script or cron job to produce `feed.xml` from `.md` frontmatter |
| Estimated reading time | Sets reader expectation upfront; reduces bounce on long posts | LOW | Word count / 200 WPM — computable in template or as frontmatter field |

### Anti-Features (Commonly Requested, Often Problematic)

Features that seem appealing but contradict the simple static blog ethos or exceed v1 scope.

| Feature | Why Requested | Why Problematic | Alternative |
|---------|---------------|-----------------|-------------|
| Comments system | Reader engagement, community | Requires dynamic backend (database, auth, spam filtering) or third-party JS (Disqus = privacy/tracking); violates no-database constraint | Email link in footer; contact page |
| Full-text search | Users want to find old posts | Client-side JS indexes (Fuse.js, lunr) bloat page load; server-side needs backend; far exceeds value at personal blog scale | Browser Ctrl+F on the index page; `grep` on the repo |
| CMS or admin UI | Easier post creation | Defeats the point — Markdown files in a text editor are the CMS; any web UI adds auth complexity | Write `.md` files directly in your preferred editor |
| User authentication | Protected drafts or admin | No auth requirement in project scope; Tailscale ACLs already provide network-level access control | Tailscale ACLs to restrict access to specific peers during draft phase |
| Pagination | Navigating many posts per page | Only needed at scale (50+ posts); adds routing complexity early; a flat dated list works at personal blog scale | Flat chronological list on index; add pagination only if list exceeds ~30 posts |
| Categories/tags with dynamic filtering | Content organization | Dynamic filtering requires JS or server logic; tags in frontmatter add maintenance burden without clear reader value at <50 posts | Meaningful post titles and dates; optionally render static tag lists if volume justifies it |
| Reading progress bar | Shows position in post | Requires JS; marginal UX value; adds complexity for negligible reader benefit | Not needed — blog posts are short enough to not need progress tracking |
| Auto-generated blog index | Readers see a sorted list without manual maintenance | Caddy cannot sort `.md` files by frontmatter date at runtime; requires a build step or script | Hand-maintained `index.md` or a script that generates it — explicit is better than magic for a personal blog |
| Real-time anything | Live updates, websockets | Contradicts static-file architecture; Caddy template handler is not a dynamic server | Static is correct here |

## Feature Dependencies

```
[Blog index page]
    └──requires──> [Frontmatter/metadata] (needs date, title to list)
                       └──requires──> [Post pages] (posts must exist)
    └──requires──> [Script or manual maintenance] (Caddy cannot auto-enumerate/sort)

[RSS/Atom feed]
    └──requires──> [Frontmatter/metadata] (title, date, description per entry)
    └──requires──> [Script] (shell script or cron generates feed.xml)

[Content negotiation]
    └──requires──> [Post pages] (the .md source files must be accessible)
    └──requires──> [Vary: Accept header] (cache correctness — not optional)
    └──enhances──> [RSS/Atom feed] (feed.xml could also be served as-is to agents)

[Syntax highlighting]
    └──requires──> [Post pages] (code blocks must be in rendered HTML)
    └──requires──> [Chroma CSS file] (Caddy emits CSS classes, not inline styles — a theme CSS file must be served)
    └──conflicts──> [Raw Markdown content negotiation] (highlighting is HTML-only;
                    raw Markdown gets verbatim fenced code blocks — correct behavior)

[Open Graph tags]
    └──requires──> [Frontmatter/metadata] (og:title, og:description from frontmatter)

[Dark mode]
    └──requires──> [Readable HTML layout] (CSS must be present to apply dark vars)

[Public internet access (any feature)]
    └──requires──> [Tailscale Funnel] (exposes localhost to internet)
    └──requires──> [Caddy TLS via Tailscale] (HTTPS termination)

[blog.mist-walleye.ts.net domain]
    └──requires──> [CNAME or alias] (Tailscale MagicDNS CNAME not yet supported —
                    must use admin console alias OR access at fedora.mist-walleye.ts.net)
    └──blocked-by──> [Terraform CNAME resource] (does not exist in tailscale/tailscale provider as of Feb 2026)
```

### Dependency Notes

- **Blog index requires frontmatter:** Without `date:` and `title:` in frontmatter, the index listing cannot be sorted or labeled. Enforces frontmatter discipline from day one.
- **RSS requires frontmatter:** Every feed entry needs title, date, and description — same discipline as index.
- **Syntax highlighting requires a Chroma CSS theme:** Caddy's `markdown` function emits HTML with CSS class names (`class="chroma"`), not inline styles. A Chroma theme CSS file (e.g., `monokai.css`) must be served alongside `style.css`. This is a non-obvious dependency.
- **Syntax highlighting conflicts with raw Markdown:** When a client requests `text/markdown`, they receive the raw fenced code block — syntax highlighting only applies to HTML output. This is correct and expected behavior.
- **Content negotiation requires `Vary: Accept`:** Without this response header, shared caches may serve the wrong variant (HTML to a Markdown client or vice versa). This is a correctness requirement, not optional.
- **CNAME is blocked by Tailscale limitation:** The Tailscale Terraform provider has no `tailscale_dns_record` or CNAME resource. The Tailscale admin console can create a node alias (MagicDNS name) manually. Terraform can manage other DNS preferences but not the CNAME itself.

## MVP Definition

### Launch With (v1 — Core Infrastructure)

Minimum viable blog — what's needed before the URL is shareable.

- [ ] Individual post pages rendering Markdown as clean HTML via Caddy `templates` — core function
- [ ] Readable CSS layout (typography, max-width, mobile-responsive) — unreadable = unusable
- [ ] Frontmatter handling (title, date rendered in template) — every post needs a title and date
- [ ] Blog index/listing page (hand-maintained `index.md`) — readers need to discover posts
- [ ] Navigation: site header with home link on every post page — basic wayfinding
- [ ] Content negotiation (HTML to browsers, raw `.md` to `Accept: text/markdown` clients) — core project differentiator per PROJECT.md; also makes the blog machine-readable by default
- [ ] Tailscale Funnel active — blog must be publicly accessible
- [ ] Caddy TLS via Tailscale cert — HTTPS required
- [ ] Terraform managing Tailscale DNS preferences — declarative infra config
- [ ] Sample article validating end-to-end pipeline — proves the system works before real content
- [ ] Chroma CSS theme file served — required for syntax highlighting to render correctly

### Add After Validation (v1.x)

Add once the basic reading experience is confirmed working.

- [ ] Dark mode — add after layout is stable; pure CSS, extremely low effort
- [ ] Open Graph tags — add before first social share; low effort
- [ ] RSS/Atom feed — add when first external reader subscribes or links the blog
- [ ] `robots.txt` — add before seeking search engine indexing

### Future Consideration (v2+)

Defer until post volume or reader demand justifies.

- [ ] `sitemap.xml` — useful for SEO after public indexing matters; script-generated
- [ ] Table of contents — only valuable for posts >2000 words; evaluate per-post
- [ ] Estimated reading time — nice-to-have, low effort; defer until content is established
- [ ] Anchor links on headings — polish; add when design is stable
- [ ] `Content-Signal` header — emerging standard; add when pattern solidifies

## Feature Prioritization Matrix

| Feature | User Value | Implementation Cost | Priority |
|---------|------------|---------------------|----------|
| Individual post pages | HIGH | LOW | P1 |
| Readable CSS layout | HIGH | LOW | P1 |
| Frontmatter (title, date) | HIGH | LOW | P1 |
| Blog index/listing | HIGH | MEDIUM | P1 |
| Content negotiation | HIGH | MEDIUM | P1 |
| Home navigation link | HIGH | LOW | P1 |
| Responsive design | HIGH | LOW | P1 |
| Tailscale Funnel (public access) | HIGH | LOW | P1 |
| Caddy TLS via Tailscale | HIGH | LOW | P1 |
| Terraform DNS config | MEDIUM | LOW | P1 |
| Chroma CSS theme | HIGH | LOW | P1 |
| Sample article (validation) | HIGH | LOW | P1 |
| Dark mode | MEDIUM | LOW | P2 |
| Open Graph tags | LOW | LOW | P2 |
| RSS/Atom feed | MEDIUM | MEDIUM | P2 |
| `robots.txt` | LOW | LOW | P2 |
| `sitemap.xml` | LOW | LOW | P3 |
| Table of contents | LOW | MEDIUM | P3 |
| Estimated reading time | LOW | LOW | P3 |
| Anchor links on headings | LOW | LOW | P3 |
| `Content-Signal` header | LOW | LOW | P3 |

**Priority key:**
- P1: Must have for launch (v1.0 Core Infrastructure)
- P2: Should have, add when possible (v1.x)
- P3: Nice to have, future consideration (v2+)

## Caddy vs SSG Comparison (What You Get and What You Don't)

This is a custom-built blog served at runtime by Caddy, not compiled by an SSG. The trade-offs are significant.

| Feature | Jekyll/Hugo (build-time SSG) | Caddy (runtime rendering) |
|---------|------------------------------|--------------------------|
| Markdown rendering | Build-time — fast, cached | Runtime — on each request via Goldmark; negligible for personal blog |
| Blog index | Auto-generated, sorted by date | Manual or script-generated `index.md` — Caddy cannot sort by frontmatter date |
| RSS feed | Built-in or plugin | Script-generated static `feed.xml` — not natively generated |
| Syntax highlighting | Build-time (Chroma/Prism) | Built-in: Caddy's `markdown` function uses Goldmark + Chroma; CSS classes output |
| Content negotiation | Not supported natively | Native Caddy strength — header matcher routes HTML vs raw Markdown |
| Dark mode | Theme-dependent | CSS `prefers-color-scheme` |
| Search | External (Algolia) or static index | Out of scope for v1 |
| Deploy complexity | Build pipeline + host | No build step — write `.md` file, it's live immediately |
| CNAME/custom domain | Full DNS control | Limited by Tailscale MagicDNS — see STACK.md |

**Key constraint:** No build step means no build-time features. Blog index and RSS are the two gaps that require a manual or scripted workaround. This is a deliberate trade-off for the simplicity of "write a file, it's live."

## Sources

- Caddy templates directive: https://caddyserver.com/docs/caddyfile/directives/templates
- Caddy templates Go package (splitFrontMatter, markdown, include): https://pkg.go.dev/github.com/caddyserver/caddy/v2/modules/caddyhttp/templates
- Caddy Goldmark + Chroma integration: https://caddy.community/t/v2-render-markdown-syntax-highlighting/9429 (HIGH confidence — confirmed via Caddy source)
- Caddy + Markdown blog walkthrough (reveals index/RSS gaps): https://blog.thomaspuppe.de/static-sites-from-markdown-with-caddy-server
- Caddy serve Markdown as HTML (TIL): https://til.jakelazaroff.com/caddy/serve-markdown-files-as-html/
- Content negotiation for AI agents (Feb 2026 state): https://www.checklyhq.com/blog/state-of-ai-agent-content-negotation/
- Use Accept header to serve Markdown to LLMs: https://www.skeptrune.com/posts/use-the-accept-header-to-serve-markdown-instead-of-html-to-llms/
- Cloudflare Markdown for Agents (Feb 2026): https://blog.cloudflare.com/markdown-for-agents/
- Tailscale MagicDNS CNAME limitation (open issue): https://github.com/tailscale/tailscale/issues/1543
- goldmark-highlighting (Caddy's Chroma integration): https://github.com/yuin/goldmark-highlighting

---
*Feature research for: Personal static Markdown blog (Caddy + Tailscale)*
*Researched: 2026-02-20*
